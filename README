FFTbor2D
________________________________________________________________

FFTbor2D computes all Boltzmann factors and ensemble free energy of k,l-neighbors of an input sequence and two input structures, where k and l are the (resp.) base pair distances from the provided input structures.

DEPENDENCIES AND INSTALLATION
________________________________________________________________

Adjust the Makefile to your preferences. The CC should be set to your compiler (g++ --version > 4.6.0 preferred) and external dependencies include LAPACK, FFTW and OpenMP. the make install command will copy the executable and energyfile to your ~/bin directory, make sure this is in your PATH environment variable for ease of use. This software was developed using FFTW 3.3.3, LAPACK 3.4.2, g++ versions 4.8.1 and 4.9.0 and ViennaRNA package version 2.1.2. Use older versions at your own risk!

USING THE CODE
________________________________________________________________

FFTbor2D [options] sequence structure_1 structure_2

FFTbor2D [options] filename
where filename is a file of the format:
	>comment (optional line)
	sequence
	secondary structure (1)
	secondary structure (2)
  
COMMAND LINE OPTIONS
________________________________________________________________

Options include the following:
-E	energyfile,    the default is rna_turner1999.par in this current directory. Must be the name of a file with all energy parameters (in the same format as used in Vienna RNA). Energy file lookup first checks the current directory, and then iterates through the PATH shell variable until a matching file is found. If no file is found, the default ViennaRNA parameters are used and a warning is presented to the user. If the -E switch is explicitly provided, that file is used in lieu of searching for the rna_turner1999.par file.
-T	temperature,   the default is 37 degrees Celsius (unless an energyfile with parameters for a different temperature is used.
-P	precision,     the default is 27, indicates the precision (base 2) of the probabilities Z_k / Z to be returned (0-53, 0 disables precision handling).
-R	row length,    the default is 100, takes an integer 0 < R <= 100 that describes the dimensions of the 2D matrix in terms of the percentage sequence length.
-M	matrix format, the default is disabled, presents output in a matrix format instead of a column format.
-S	simple output, the default is disabled, presents output in column format, for non-zero entries only with no header output (columns are: k, l, p(Z_{k,l}/Z), -RTln(Z_{k,l})).
-X\tMFPT,          the default is disabled, estimates the mean-first passage time of the input RNA from structure 1 to structure 2.

ANNOTATED FILE LIST
________________________________________________________________

Files:

main.cpp                   - the main program file, reads input and prints output
partition.cpp, partition.h - the algorithm implementation
misc.cpp, misc.h           - a few additional functions and global variables
energy_const.h,
energy_par.h,
params.h                   - three h-files from Vienna RNA, these define energy parameters.
rna_turner1999.par         - The energy parameters.
libRNA.a                   - Vienna RNA library file, this file is not included in this source, but is included in the Vienna RNA package. This implementation requires ViennaRNA >= 2.1.2